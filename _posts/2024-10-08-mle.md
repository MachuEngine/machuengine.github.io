---
layout: "single"
title: "[패턴인식] Maximum likelihood estimation"
categories:
  - study
tags:
  - 패턴인식
---

## Maximum likelihood estimation
MLE : 최대 우도 추정 [parametric, 모수적 추정 방법]

주어진 데이터 X를 통해 parameter 매개변수 Θ를 추정하는 방법이다.  

**주어진 X를 발생시켰을 가능성이 가장 높은 매개변수 Θ를 찾아라.**  
**주어진 X에 대해 가장 큰 우도를 갖는 Θ를 찾아라.**

정규 분포로 가정하는 경우 매개변수는 **평균 μ**과 **분산 Σ(공분산 행렬)**이다.

## 최대 우도 STEP
1. 다음 우도가 최대가 되는 Θ는 ? 
<img src="/assets/images/mle4.png" alt="">

2. 모든 X 샘플이 독립적으로 추출되었다고 가정하면, 아래와 같이 나타낼 수 있다. 
[**iid** : Independent and identically distributed random variables]
<img src="/assets/images/mle3.png" alt="">

3. 우도에 로그를 취해 곱을 합으로 나타내면,
<img src="/assets/images/mle2.png" alt="">

4. 우도의 최대값을 알기 위해 Θ에 대해 미분한 값을 0으로,
<img src="/assets/images/mle1.png" alt="">

## 추정하려는 분포가 정규 분포라고 가정한다면?
- 가정 1 : X가 정규 분포에서 추출되었다. (매개변수는 **평균 μ**과 **분산 Σ(공분산 행렬)**)
- 가정 2 : 공분산 행렬은 이미 알고 있다. (공분산 행렬 Σ를 상수로)

### 유도 1
식을 풀이하면 최종적으로 도함수가 0이라고 두었을 때,  
<img src="/assets/images/mle6.png" alt="">

**최적의 매개 변수 중 평균 벡터 μ**는 **샘플들의 평균 벡터 식**으로 표현된다.

### 유도 2 
가정 2을 아래와 같이 변경하면,
- 가정 2 : 평균은 이미 알고 있다. (평균 벡터 μ는 상수)

그럼, 공분산 행렬 Σ만 변수로 생각하면 되므로, Σ에 대해서 미분하고 0으로 두면,  
아래와 같이 샘플들의 공분산 식으로 표현된다. (1/(N-1) 와 1/N차이는 샘플 개수가 무수히 많아지면 무시될 수 있을 것으로 보인다.)

<img src="/assets/images/mle5.png" alt="">

## 결론
정규 분포로 가정하고 ML방법으로 최적의 매개변수를 구하면 실제 샘플들의 평균과 공분산임을 알 수 있다.
MLE방법은 사전 확률이 모든 케이스에서 동일하다고 가정하고(무시되고) 푼 방법인데, 다음으로 정리할 MAP방법은 
사전 확률이 케이스마다 다른 경우를 고려한 방법이다. 